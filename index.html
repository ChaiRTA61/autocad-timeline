<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Timeline ‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏° Upload Image & Import CSV</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }

    #uploadBox {
      width: 300px;
      height: 200px;
      background-color: black;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 20px;
      cursor: pointer;
    }

    #uploadBtn {
      color: white;
      background: transparent;
      border: 2px dashed white;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
      font-size: 16px;
      position: absolute;
      z-index: 2;
    }

    #previewImage {
      max-width: 100%;
      max-height: 100%;
      display: none;
      cursor: pointer;
      object-fit: cover;
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    #fileInput {
      display: none;
    }

    #formSection {
      display: none;
      position: fixed;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      background: #f2f2f2;
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1000;
      width: 300px;
    }

    label, input { display: block; margin: 5px 0; width: 100%; box-sizing: border-box; }
    #timeline { height: 500px; margin-top: 30px; }
    #taskList { margin-top: 20px; }
    button { margin-top: 10px; padding: 8px 15px; cursor: pointer; border-radius: 5px; border: 1px solid #ccc; background-color: #e0e0e0; }
    button:hover { background-color: #d0d0d0; }

    .task-item {
      margin-bottom: 8px;
      background: #f9f9f9;
      padding: 5px 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
    }

    .import-section {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #eee;
      border-radius: 8px;
      background-color: #fcfcfc;
    }
    .import-section h3 { margin-top: 0; }
  </style>
</head>
<body>

<h2>üì∑ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</h2>
<div id="uploadBox" onclick="imageClick()">
  <button id="uploadBtn" onclick="triggerUpload(event)">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û</button>
  <input type="file" id="fileInput" accept="image/*" onchange="handleUpload(event)">
  <img id="previewImage" alt="Preview Image">
</div>

<h2>üìÖ Timeline ‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö</h2>

<div class="import-section">
  <h3>‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Excel (‡πÑ‡∏ü‡∏•‡πå CSV)</h3>
  <p>‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå Excel ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
  <ol>
    <li>‡∏•‡∏≥‡∏î‡∏±‡∏ö (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ)</li>
    <li>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå (‡∏´‡∏£‡∏∑‡∏≠ ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô)</li>
    <li>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1,2,3)</li>
    <li>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏° (‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD ‡πÄ‡∏ä‡πà‡∏ô 2023-01-15)</li>
    <li>‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î (‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD ‡πÄ‡∏ä‡πà‡∏ô 2023-01-20)</li>
    <li>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô</li>
  </ol>
  <p>‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå **CSV (Comma Separated Values)**</p>
  <input type="file" id="csvFileInput" accept=".csv" onchange="handleCsvUpload(event)">
  <button onclick="document.getElementById('csvFileInput').click()">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå CSV</button>
  <button onclick="clearAllData()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
</div>

<div id="formSection">
  <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå: <input type="text" id="projectName"></label>
  <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°: <input type="date" id="startDate"></label>
  <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î: <input type="date" id="endDate"></label>
  <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô: <input type="text" id="taskDetails" placeholder="‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1,2,3"></label>
  <label>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô: <input type="text" id="ownerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô"></label>
  <button onclick="addToTimeline()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
  <button onclick="closeForm()">‡∏õ‡∏¥‡∏î</button>
</div>

<div id="timeline"></div>
<div id="taskList"></div>

<script>
  google.charts.load("current", { packages: ["timeline"] });
  google.charts.setOnLoadCallback(initChart);

  let chart, dataTable;
  let timelineData = [];

  const uploadBtn = document.getElementById("uploadBtn");
  const fileInput = document.getElementById("fileInput");
  const previewImage = document.getElementById("previewImage");
  const csvFileInput = document.getElementById("csvFileInput"); // CSV input element

  window.addEventListener("load", () => {
    const savedImage = localStorage.getItem("uploadedImage");
    if (savedImage) {
      previewImage.src = savedImage;
      previewImage.style.display = "block";
      uploadBtn.style.display = "none";
    }

    const saved = localStorage.getItem("timelineData");
    if (saved) {
      timelineData = JSON.parse(saved);
    }
    initChart(); // Ensure chart is initialized and drawn with saved data
  });

  function triggerUpload(event) {
    event.stopPropagation();
    fileInput.click();
  }

  function handleUpload(event) {
    const file = event.target.files[0];
    if (!file || !file.type.startsWith("image/")) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      previewImage.src = e.target.result;
      previewImage.style.display = "block";
      uploadBtn.style.display = "none";
      localStorage.setItem("uploadedImage", e.target.result);
    };
    reader.readAsDataURL(file);
  }

  function imageClick() {
    fileInput.click();
  }

  function initChart() {
    const container = document.getElementById("timeline");
    chart = new google.visualization.Timeline(container);
    dataTable = new google.visualization.DataTable();
    dataTable.addColumn({ type: "string", id: "‡∏á‡∏≤‡∏ô" });
    dataTable.addColumn({ type: "string", role: "tooltip", p: { html: true } });
    dataTable.addColumn({ type: "date", id: "‡πÄ‡∏£‡∏¥‡πà‡∏°" });
    dataTable.addColumn({ type: "date", id: "‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î" });
    drawChart();
    renderTaskList();
  }

  function createTooltipHtml(name, owner, details) {
    return `
      <div style="padding:10px; font-size:14px;">
        <strong>üìå ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô:</strong> ${name}<br/>
        <strong>üë§ ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô:</strong> ${owner}<br/>
        <strong>üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong><br/>${details.replace(/,/g, "<br/>")}
      </div>`;
  }

  function drawChart() {
    if (dataTable.getNumberOfRows() > 0) {
      dataTable.removeRows(0, dataTable.getNumberOfRows());
    }
    
    timelineData.forEach(row => {
      const name = row[0];
      const start = row[1];
      const end = row[2];
      const details = row[3];
      const owner = row[4];

      // Validate dates before adding to chart
      if (isNaN(new Date(start).getTime()) || isNaN(new Date(end).getTime())) {
          console.warn(`Skipping row due to invalid date: ${row}`);
          return; // Skip this row if dates are invalid
      }

      const tooltip = createTooltipHtml(name, owner, details);
      dataTable.addRow([name, tooltip, new Date(start), new Date(end)]);
    });
    
    chart.draw(dataTable, { tooltip: { isHtml: true } });
  }

  function renderTaskList() {
    const container = document.getElementById("taskList");
    container.innerHTML = "<h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô</h3>";
    if (timelineData.length === 0) {
        container.innerHTML += "<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>";
        return;
    }
    timelineData.forEach((row, index) => {
      const name = row[0];
      const start = row[1];
      const end = row[2];
      const details = row[3];
      const owner = row[4];

      const div = document.createElement("div");
      div.className = "task-item";
      div.innerHTML = `
        üõ†Ô∏è <strong>${name}</strong><br/>
        üìÖ ${start} ‡∏ñ‡∏∂‡∏á ${end}<br/>
        üë§ ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô: ${owner}<br/>
        üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${details}
        <br/><button onclick="deleteTask(${index})">üóëÔ∏è ‡∏•‡∏ö</button>
      `;
      container.appendChild(div);
    });
  }

  function addToTimeline() {
    const name = document.getElementById("projectName").value.trim();
    const start = document.getElementById("startDate").value;
    const end = document.getElementById("endDate").value;
    const details = document.getElementById("taskDetails").value.trim();
    const owner = document.getElementById("ownerName").value.trim();

    if (!name || !start || !end || !details || !owner) {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á");
      return;
    }

    if (new Date(start) > new Date(end)) {
      alert("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î");
      return;
    }

    const row = [name, start, end, details, owner];
    timelineData.push(row);
    localStorage.setItem("timelineData", JSON.stringify(timelineData));
    drawChart();
    renderTaskList();
    clearInputs();
    closeForm(); 
  }

  function deleteTask(index) {
    if (confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
      timelineData.splice(index, 1);
      localStorage.setItem("timelineData", JSON.stringify(timelineData));
      drawChart();
      renderTaskList();
    }
  }

  function clearInputs() {
    document.getElementById("projectName").value = "";
    document.getElementById("startDate").value = "";
    document.getElementById("endDate").value = "";
    document.getElementById("taskDetails").value = "";
    document.getElementById("ownerName").value = "";
  }

  function closeForm() {
    document.getElementById("formSection").style.display = "none";
  }

  // --- CSV Import Functions ---
  function handleCsvUpload(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
      const csvContent = e.target.result;
      parseCsvData(csvContent);
    };
    reader.readAsText(file, 'UTF-8'); // Read as UTF-8 to handle Thai characters
  }

  function parseCsvData(csvString) {
    const lines = csvString.split('\n');
    let importedCount = 0;
    let errorCount = 0;

    // Optional: Skip header row if your CSV has one (uncomment next line if needed)
    // lines.shift(); 

    lines.forEach((line, index) => {
      // Basic CSV parsing: split by comma, trim whitespace
      // Be aware that more complex CSVs with commas in data might need a robust parser
      const columns = line.split(',').map(col => col.trim());

      // Validate minimum number of columns and date formats
      // Expected columns: ‡∏•‡∏≥‡∏î‡∏±‡∏ö, ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå, ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°, ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î, ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô
      // We expect at least 6 columns, even if '‡∏•‡∏≥‡∏î‡∏±‡∏ö' is empty.
      if (columns.length < 6) {
        if (line.trim() !== '') { // Only report non-empty lines as errors
            console.warn(`Skipping malformed row ${index + 1}: Not enough columns. Line: "${line}"`);
            errorCount++;
        }
        return; 
      }

      // Map CSV columns to our timelineData format: [name, start, end, details, owner]
      // Excel/CSV columns: a ‡∏•‡∏≥‡∏î‡∏±‡∏ö, b ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô, c ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô, d ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°, e ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î
      // Map to:                 [name,   start,     end,      details,     owner]
      // Our CSV order: [‡∏•‡∏≥‡∏î‡∏±‡∏ö, ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô, ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô, ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°, ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î, ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô]
      const name = columns[1] || `Untitled Task ${timelineData.length + 1}`; // b ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô
      const details = columns[2] || ''; // c ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô
      const startDateStr = columns[3]; // d ‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
      const endDateStr = columns[4];   // e ‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î
      const owner = columns[5] || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'; // f ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô

      // Validate date format (YYYY-MM-DD)
      const isValidStartDate = /^\d{4}-\d{2}-\d{2}$/.test(startDateStr);
      const isValidEndDate = /^\d{4}-\d{2}-\d{2}$/.test(endDateStr);

      if (!isValidStartDate || !isValidEndDate) {
          console.warn(`Skipping row ${index + 1}: Invalid date format (expected YYYY-MM-DD). Start: "${startDateStr}", End: "${endDateStr}". Line: "${line}"`);
          errorCount++;
          return;
      }

      // Convert date strings to Date objects for validation, but store as strings
      const startDateObj = new Date(startDateStr);
      const endDateObj = new Date(endDateStr);

      if (isNaN(startDateObj.getTime()) || isNaN(endDateObj.getTime())) {
          console.warn(`Skipping row ${index + 1}: Invalid date value. Start: "${startDateStr}", End: "${endDateStr}". Line: "${line}"`);
          errorCount++;
          return;
      }
      
      if (startDateObj > endDateObj) {
          console.warn(`Skipping row ${index + 1}: Start date after end date. Line: "${line}"`);
          errorCount++;
          return;
      }

      // If all validations pass, add to timelineData
      timelineData.push([name, startDateStr, endDateStr, details, owner]);
      importedCount++;
    });

    if (importedCount > 0) {
        localStorage.setItem("timelineData", JSON.stringify(timelineData));
        drawChart();
        renderTaskList();
        alert(`‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${importedCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£. ${errorCount > 0 ? `‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ${errorCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£.` : ''}`);
    } else if (errorCount > 0) {
        alert(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ${errorCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV`);
    } else {
        alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå CSV ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤");
    }
  }

  // --- Clear All Data Function ---
  function clearAllData() {
    if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö.")) {
      timelineData = [];
      localStorage.removeItem("timelineData");
      drawChart(); // Redraw chart with empty data
      renderTaskList(); // Update task list
      alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß");
    }
  }


  // Show the form when clicking anywhere on the page for the first time,
  // but prevent it from showing if clicking elements within the upload box or CSV import section.
  let formShownOnce = false; 
  document.addEventListener("click", function (event) {
    const formSection = document.getElementById("formSection");
    const uploadBox = document.getElementById("uploadBox");
    const importSection = document.querySelector(".import-section"); // Select the new import section

    // If the form hasn't been shown yet AND the click is not inside the form AND not inside the upload box AND not inside the import section
    if (!formShownOnce && 
        !formSection.contains(event.target) && 
        !uploadBox.contains(event.target) &&
        !importSection.contains(event.target)) {
      formSection.style.display = "block";
      formShownOnce = true; 
    }
  }); 

</script>

</body>
</html>
